using System;
using System.IO;
using System.Linq;
using System.Text;
using System.Windows.Forms;
using System.Threading.Tasks;
using System.Collections.Generic;

public class MainClass
{
	/// <summary>
	/// Template text defined above
	/// </summary>
	public string Template { get; set; }

	/// <summary>
	/// Dictionary with variables filled by user
	/// </summary>
	public Dictionary<string, string> Variables { get; set; }

	/// <summary>
	/// Text taken from clipboard
	/// </summary>
	public string ClipboardText 
	{ 
		get
		{
			return Clipboard.GetText();
		}
		set
		{
			if(value != null)
			{
				if(value.Length > 0)
				{
					Clipboard.SetText(value);
				}
			}
		}
	}

	private void SetVariables2Template()
	{
		foreach(var variable in Variables)
		{
			Template = Template.Replace("%" + variable.Key + "%", variable.Value);
		}
	}

	/// <summary>
	/// Application entry point
	/// </summary>
	public void Main()
	{
		SetVariables2Template();
		ClipboardText = Template;
	}
}
