Imports System
Imports System.IO
Imports System.Linq
Imports System.Text
Imports System.Windows.Forms
Imports System.Threading.Tasks
Imports System.Collections.Generic

Public Class MainClass
	''' <summary>
	''' Template text defined above
	''' </summary>
	Property Template As String

	''' <summary>
	''' Dictionary with variables filled by user
	''' </summary>
	Property Variables As Dictionary(Of String, String)
	''' <summary>
	''' Text taken from clipboard
	''' </summary>
	Public Property ClipboardText As String
		Get
			Return Clipboard.GetText()
		End Get

		Set
			If Value <> Nothing Then
				If Value <> "" Then
					Clipboard.SetText(Value)
				End If
			End If
		End Set

	End Property

	Private Sub SetVariables2Template()
		For Each variable As KeyValuePair(Of String, String) In Variables
			Template = Template.Replace("%" + variable.Key + "%", variable.Value)
		Next
	End Sub

	''' <summary>
	''' Application entry point
	''' </summary>
	Public Sub Main()
		SetVariables2Template()
		ClipboardText = Template
	End Sub

End Class
